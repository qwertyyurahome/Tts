<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Multi-Language Female TTS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body { font-family: Arial; padding: 20px; background: #f0f0f0; }
  h2 { margin-bottom: 5px; }
  textarea { width: 100%; height: 140px; font-size:16px; margin-bottom:10px; padding:10px; }
  select, button { width: 100%; padding: 10px; font-size:16px; margin-top:5px; }
  button { cursor: pointer; }
</style>
</head>
<body>

<h2>Multi-Language Female TTS</h2>
<p>Select voice and language:</p>

<textarea id="text" placeholder="Enter text here..."></textarea>
<select id="voiceSelect"></select>

<button onclick="speak()">▶ Speak</button>
<button onclick="stopSpeech()">⏹ Stop</button>

<script>
let voices = [];
const select = document.getElementById('voiceSelect');
let currentUtterance = null;

// Функція для завантаження голосів
function populateVoices() {
  voices = speechSynthesis.getVoices();
  select.innerHTML = '';
  if(voices.length === 0) {
    console.log("Голоси ще не завантажені, чекаємо...");
    return;
  }
  voices.forEach((voice, i) => {
    // Відображаємо всі жіночі голоси
    const nameLower = voice.name.toLowerCase();
    if(nameLower.includes('female') || nameLower.includes('f')) {
      const option = document.createElement('option');
      option.value = i;
      option.textContent = voice.name + ' (' + voice.lang + ')';
      select.appendChild(option);
    }
  });
}

// Декілька спроб завантажити голоси для Android
function waitForVoices() {
  populateVoices();
  if(select.options.length === 0) {
    setTimeout(waitForVoices, 500); // повторити через 0.5 секунди
  }
}
waitForVoices();
speechSynthesis.onvoiceschanged = populateVoices;

function speak() {
  const text = document.getElementById('text').value.trim();
  if(!text) return;

  const index = select.value;
  if(index === undefined) {
    alert("Голоси ще не завантажені. Спробуйте через кілька секунд.");
    return;
  }

  const utter = new SpeechSynthesisUtterance(text);
  utter.voice = voices[index];
  utter.lang = utter.voice.lang;

  speechSynthesis.cancel();
  currentUtterance = utter;
  speechSynthesis.speak(utter);
}

function stopSpeech() {
  if(currentUtterance) {
    speechSynthesis.cancel();
  }
}
</script>

</body>
</html>